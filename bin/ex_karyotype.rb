require 'yaml'

require_relative '../lib/cytogenetics'
require 'logger'

log = Logger.new(STDOUT)
log.level = Logger::INFO
Cytogenetics.logger = log


kts = [
    "43-45,XY,add(2;3)(q1?3),-3,-5,dic(13;13)(q14;q32),der(6)t(2;6)(q12;p12)t(1;6)(p22;q21),der(5)t(5;17)(q13;q21),-7,i(8)(q10),-11,-17,ider(19)(q10)add(19)(q13)",
    "46(45-49), XY, 1x1, der(1)t(1;4), 2x2, 3x1, der(3)t(5;3;7), der(3)t(3;5)(p12;p12), der(4)t(4;1;4;7), der(4)del(4)t(4;7), der(5)t(4;5), i(5p), der(5?)t(5;18), 6x2, der(6)t(6;8), 7x1, 8x2, 9x2, 10x2, 11x2, 12x2, 13x2, der(13)t(8;13), 14x2, 15x2, dup(15), 16x2, 17x2, 18x1, der(18)t(14;18;8), 19x2, 20x1, 21x2, 22x2",
    "66~185<5n>,XXXX,+X[3],-X[3],del(X)(q22)[7],+del(X)(q22)[5],+del(X)(q22)[3],-1[5],+2[2],-2[4],del(2)(p21)[2],+3[2],-3[4],+4[3],-4[4],+5[6],+5[4],+5[2],+5[2],+der(5;21)(p10;q10)[4],-6[6],-6[4],+7[6],+7[4],+7[2],+del(7)(p14)[3],+8[5],+8[3],+8[2],-9[6],-9[6],-10[6],-10[5],del(10)(q21)[3],-11[5],del(11)(p14)[2],del(11)(q11)[4],del(11)(q11)[2],der(11)del(11)(p14)del(11)q(23)[2],-12[4],-12[3],-13[4],-13[3],+del(13)(q22)[3],-14[7],-14[5],-14[3],-15[4],-15[3],del(15)(q22)x2[5],+16[3],-16[4],-16[3],+17[6],del(17)(p11)x2[8],+del(17)(p11)x2[6],-18[5],-18[4],der(18)t(14;18)(q1?3;p11.3)[2],-19[6],-19[3],der(19;21)(?p10;q10)[2],+20[2],-20[5],+21[3],-21[3],-21[3],+22[2],-22[5],3~8min[5]",
    "46, XX, t(12;14)(q14;q23)"
]


k = "43-45,XY,add(2;3)(q13),-3,-5,dic(13;13)(q14;q32),dic(1;19)(q12;q13),der(6)t(2;6)(q12;p12)t(1;6)(p22;q21),der(5)t(5;17)(q13;q21),-7,i(8)(q10),-11,-17,ider(19)(q10)add(19)(q13)"

k = "46, XX, dic(12;14)(q14;q23),1~9dmin(8),t(12;14)(q14;q23)"

k = " 43-76<+3n>,XX,-Y,+der(1;14)(q10;q10)[2],der(3)t(3;5)(p12;q11.2),-6,+7,+7,i(8)(q10),-9,del(11)(q12),+der(11)t(9:11)(q13;q13),+12,+del(12)(q22),-13,der(14)t(11;14)(q11.2;p11.2),der(14)t(5;14)(?;p11.2),+15,+17,+del(19)(p13.2),+20[cp9]"

k= "31-75,XY,+X,+Y,+1,-2,der(2)t(2;3)(q31;q12),-3,+5,+6,+7,+8,-8,i(8)(q10),-9,der(10)t(9;10)(q31;q33),idic(9)(q13); +10,+11,+12,-13,-14,+15,+16,-17,-18,+19,-19,der(19)t(13;19)(q31;p13.1),+20,+21,der(22)t(4;1;22;1)(p14;p34;p11.2;p24)del(1)p21-31,-22,cp[10]"
#k = kts[-1]

kt = Cytogenetics.karyotype(k)
puts "Breakpoints:\n\t" + kt.report_breakpoints.join("\n\t")
puts "Aberrations:\n\t" + YAML::dump(kt.aberrations)
#puts "Fragments:\n\t" + kt.report_fragments.join("\n\t")
#puts kt.abnormal_chr
#puts kt.normal_chr
puts kt.associate_bp_to_abr

